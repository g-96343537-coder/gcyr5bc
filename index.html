<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>äº”å¹´çº§è¯­æ–‡ç»ƒä¹ </title>
<style>
  :root{
    --card-bg: rgba(255,255,255,0.95);
    --text:#4a2c2a;
    --blue:#64b5f6;
    --green:#81c784;
    --red:#e57373;
    --orange:#ff7043;
    --brown:#5d4037;
  }
  body{
    margin:0;padding:0;
    font-family:'Ma Shan Zheng','Comic Neue','Microsoft YaHei',sans-serif;
    background-size:cover;background-position:center;
    background-image:url('https://wallpapercave.com/wp/e4rDnTH.jpg');
    background-attachment: fixed;
    color:var(--text);
    min-height:100vh;
  }
  h1{text-align:center;color:#bf360c;text-shadow:2px 2px 0 #ffe0b2;margin:20px 0 10px;font-size:2.2rem}
  
  .wrap{max-width:820px;margin:auto;padding:12px}
  
  /* ====== é€šç”¨å¡ç‰‡æ ·å¼ ====== */
  .card{
    background:var(--card-bg);
    border-radius:20px;
    padding:20px;
    margin:16px auto;
    box-shadow:0 10px 30px rgba(0,0,0,0.15);
    transition:transform 260ms ease;
    border: 1px solid #e0e0e0;
  }
  .card:hover{transform:translateY(-5px)}

  /* ====== 1. å¼€å§‹ç”»é¢æ ·å¼ ====== */
  #start-screen {
    max-width: 500px;
    text-align: center;
    padding: 40px 30px;
    margin-top: 60px;
    background: rgba(255, 255, 255, 0.96);
    border: 2px solid #d84315;
  }
  
  .input-group {
    margin-bottom: 25px;
    text-align: left;
  }
  .input-group label {
    display: block;
    font-size: 1.3rem;
    margin-bottom: 8px;
    font-weight: bold;
    color: var(--brown);
  }
  .input-group input, .input-group select {
    width: 100%;
    padding: 12px;
    font-size: 1.1rem;
    border: 2px solid #ffcc80;
    border-radius: 12px;
    box-sizing: border-box;
    outline: none;
    font-family: inherit;
    background-color: #fff8e1;
  }
  .input-group input:focus, .input-group select:focus {
    border-color: #ff6f00;
    background-color: #fff;
  }
  
  #startBtn {
    font-size: 1.6rem;
    padding: 12px 60px;
    background: linear-gradient(to bottom, #ff7043, #d84315);
    color: white;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 0 #bf360c;
    transition: transform 0.1s;
    margin-top: 15px;
    font-family: inherit;
  }
  #startBtn:active { transform: translateY(3px); box-shadow: none; }

  /* ====== 2. ç»ƒä¹ å†…å®¹æ ·å¼ (åˆå§‹éšè—) ====== */
  #quiz-content { display: none; }

  #student-info-bar {
    background: rgba(255, 252, 240, 0.95);
    padding: 12px 25px;
    border-radius: 15px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    color: var(--brown);
    border-left: 6px solid #d84315;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    font-size: 1.1rem;
  }

  /* ====== é¢˜ç›®ä¸é€‰é¡¹ ====== */
  .q{font-size:1.3rem;margin-bottom:15px; line-height: 1.6;}
  .choices{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
  .choice{
    min-width:120px;
    padding:12px 20px;
    border:none;border-radius:16px;
    font-size:1.1rem;
    cursor:pointer;
    color:#3e2723;
    background:linear-gradient(to bottom,#fff3e0,#ffe0b2);
    box-shadow:0 6px 0 rgba(0,0,0,0.12);
    transition:transform .2s, background .2s;
    font-family: inherit;
  }
  .choice:hover{transform:translateY(-3px)}
  .choice:active{transform:translateY(2px); box-shadow:none;}
  
  .choice.correct{background:linear-gradient(to bottom,#a5d6a7,#66bb6a);color:#1b5e20; box-shadow:none; cursor:default;}
  .choice.wrong{background:linear-gradient(to bottom,#ef9a9a,#e57373);color:#b71c1c; box-shadow:none; cursor:default;}
  
  .choice:disabled { cursor: default; }

  /* åº•éƒ¨ç»Ÿè®¡æ¡ */
  .result-bar {
    position: sticky;
    bottom: 20px;
    background: rgba(255, 255, 255, 0.95);
    padding: 15px;
    border-radius: 50px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    text-align: center;
    font-weight:bold;
    font-size:1.3rem;
    color: #bf360c;
    border: 2px solid #ffab91;
    max-width: 400px;
    margin: 20px auto;
    z-index: 100;
  }

  @keyframes flashGreen{0%{transform:scale(1)}40%{transform:scale(1.06)}100%{transform:scale(1)}}
  .correct-flash{animation:flashGreen 700ms ease;}
</style>
</head>
<body>
  <h1>ğŸŒˆ äº”å¹´çº§æˆè¯­ç»ƒä¹ </h1>
  
  <div class="wrap">
    
    <div id="start-screen" class="card">
        <h2 style="color:#d84315; margin-top:0;">æ¬¢è¿è¿›å…¥æˆè¯­ä¹å›­ ğŸ®</h2>
        <div class="input-group">
            <label for="student-name">å§“å (Nama)ï¼š</label>
            <input type="text" id="student-name" placeholder="è¯·è¾“å…¥ä½ çš„åå­—..." autocomplete="off">
        </div>
        <div class="input-group">
            <label for="student-class">ç­çº§ (Kelas)ï¼š</label>
            <select id="student-class">
                <option value="">è¯·é€‰æ‹©ç­çº§</option>
                <option value="5M">5M</option>
                <option value="5K">5K</option>
                <option value="5B">5B</option>
                <option value="5H">5H</option>
                <option value="5J">5J</option>
                <option value="5U">5U</option>
                <option value="5P">5P</option>
                <option value="5C">5C</option>
            </select>
        </div>
        <button id="startBtn">å¼€å§‹æŒ‘æˆ˜</button>
    </div>

    <div id="quiz-content">
        <div id="student-info-bar">
            <span id="display-name">å­¦ç”Ÿï¼š-</span>
            <span id="display-class">ç­çº§ï¼š-</span>
        </div>
        <div id="pageArea"></div>
        <div class="result-bar" id="score">ğŸŒŸ æ­£ç¡®ï¼š0 / å·²ç­”ï¼š0</div>
    </div>

  </div>

<script>
// ====== ä½ çš„æ–° Google Apps Script é“¾æ¥ ======
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwfWdWFEvgqrHEPrqcwlHbraOL3EeZNP20qO63COmzXs3JJ1F-qjwEJ501VHXGNt_VB/exec";

// ====== é¢˜ç›®æ•°æ® ======
const questions = [
  {q:'å¬äº†è€å¸ˆçš„è¯¦ç»†è§£é‡Šåï¼Œæˆ‘æ‰______ï¼Œæ˜ç™½äº†è¿™é“æ•°å­¦é¢˜çš„è§£æ³•ã€‚',
   o:['æ‰§è¿·ä¸æ‚Ÿ','æç„¶å¤§æ‚Ÿ','æƒŠå¼“ä¹‹é¸Ÿ','å“‘å£æ— è¨€'], a:1},

  {q:'åœ¨è¿™______çš„æ—¶åˆ»ï¼Œæ¶ˆé˜²å‘˜å†²è¿›ç«åœºæ•‘å‡ºäº†å—å›°çš„å°å­©ã€‚',
   o:['æ— è®ºå¦‚ä½•','æ¼«ä¸ç»å¿ƒ','åƒé’§ä¸€å‘','ä¸ä»¥ä¸ºç„¶'], a:2},

  {q:'ä»–é‚£ç§______çš„ç²¾ç¥ï¼ŒçœŸè®©äººä½©æœï¼Œå³ä½¿å¤±è´¥äº†ä¹Ÿä¸è½»æ˜“æ”¾å¼ƒã€‚',
   o:['åŠé€”è€ŒåºŸ','ç™¾æŠ˜ä¸æŒ ','å‚å¤´ä¸§æ°”','å¾—è¿‡ä¸”è¿‡'], a:1},

  {q:'çœ‹åˆ°æ¡Œä¸Šé‚£ç›˜é¦™å–·å–·çš„ç‚¸é¸¡ï¼Œå¼Ÿå¼Ÿä¸ç¦______ï¼Œåµç€è¦åƒã€‚',
   o:['å‚æ¶ä¸‰å°º','é¥¥ä¸æ‹©é£Ÿ','ç‹¼åè™å’½','æ´¥æ´¥æœ‰å‘³'], a:0},

  {q:'æ—¢ç„¶ä½ å·²ç»çŸ¥é“é”™äº†ï¼Œåªè¦______ï¼Œå¤§å®¶ä¸€å®šä¼šåŸè°…ä½ çš„ã€‚',
   o:['å°†é”™å°±é”™','æ”¹è¿‡è‡ªæ–°','æ‰§è¿·ä¸æ‚Ÿ','è‡ªæš´è‡ªå¼ƒ'], a:1},

  {q:'æå”å”ä¸ºäºº______ï¼Œå¤„ç†äº‹æƒ…ä»æ¥ä¸åè¢’ä»»ä½•äººï¼Œæ·±å—å¤§å®¶æ•¬é‡ã€‚',
   o:['æ–¤æ–¤è®¡è¾ƒ','å¤§å…¬æ— ç§','å‡å…¬æµç§','è¢–æ‰‹æ—è§‚'], a:1},

  {q:'å³ä½¿åœ¨å›½å¤–ç”Ÿæ´»å¤šå¹´ï¼Œçˆ·çˆ·ä¾ç„¶______ï¼Œå¸Œæœ›èƒ½æ—©æ—¥å›åˆ°æ•…ä¹¡ã€‚',
   o:['ä¹ä¸æ€èœ€','å½’å¿ƒä¼¼ç®­','æµè¿å¿˜è¿”','å››æµ·ä¸ºå®¶'], a:1},

  {q:'é¢å¯¹çªå¦‚å…¶æ¥çš„æ„å¤–ï¼Œæˆ‘ä»¬å¿…é¡»ä¿æŒå†·é™ï¼Œåƒä¸‡ä¸è¦______ã€‚',
   o:['ä¸´å±ä¸ä¹±','æ‰‹å¿™è„šä¹±','å¤„ä¹‹æ³°ç„¶','äº•äº•æœ‰æ¡'], a:1},

  {q:'å¦ˆå¦ˆå¯¹æˆ‘ä»¬çš„ç…§é¡¾______ï¼Œè®©æˆ‘ä»¬æ„Ÿå—åˆ°å®¶åº­çš„æ¸©æš–ã€‚',
   o:['æ— å¾®ä¸è‡³','æ•·è¡å¡è´£','æ¼ ä¸å…³å¿ƒ','ç²—å¿ƒå¤§æ„'], a:0},

  {q:'è¿™ä½æ¼”è®²è€…åœ¨å°ä¸Š______åœ°å‘è¡¨çœ‹æ³•ï¼Œèµ¢å¾—äº†è§‚ä¼—çƒ­çƒˆçš„æŒå£°ã€‚',
   o:['åååå','æ²‰é»˜å¯¡è¨€','æ»”æ»”ä¸ç»','çªƒçªƒç§è¯­'], a:2},

  {q:'åªè¦æˆ‘ä»¬______ï¼Œä¸ç®¡æ˜¯å¤šå¤§çš„å›°éš¾ï¼Œéƒ½ä¸€å®šèƒ½å¤Ÿå…‹æœã€‚',
   o:['å„æŒå·±è§','ä¼—å¿—æˆåŸ','å­¤æŒéš¾é¸£','è¢–æ‰‹æ—è§‚'], a:1},

  {q:'ç»è¿‡å¤šæ¬¡çš„åŠå‘Šï¼Œä»–ä¾ç„¶______ï¼Œç»§ç»­æ²‰è¿·äºç½‘ç»œæ¸¸æˆã€‚',
   o:['æ‚¬å´–å‹’é©¬','æ‰§è¿·ä¸æ‚Ÿ','å›å¿ƒè½¬æ„','å½“æœºç«‹æ–­'], a:1},

  {q:'é‚£ä½è‹±é›„______çš„çˆ±å›½ç²¾ç¥ï¼Œå°†è¢«åäººæ°¸è¿œé“­è®°ã€‚',
   o:['è§†æ­»å¦‚å½’','è´ªç”Ÿæ€•æ­»','èƒ†å°å¦‚é¼ ','è‹Ÿä¸”å·ç”Ÿ'], a:0},

  {q:'è¿™ä»¶äº‹æƒ…å…³ç³»é‡å¤§ï¼Œä½ å¿…é¡»______ï¼Œåƒä¸‡ä¸å¯è‰ç‡åšå†³å®šã€‚',
   o:['æ‰ä»¥è½»å¿ƒ','ä¸‰æ€è€Œè¡Œ','å½“æœºç«‹æ–­','éšå¿ƒæ‰€æ¬²'], a:1},

  {q:'çœ‹åˆ°åŒå­¦æœ‰å›°éš¾ï¼Œæˆ‘ä»¬åº”è¯¥ä¼¸å‡ºæ´æ‰‹ï¼Œç»ä¸èƒ½______ã€‚',
   o:['åŠ©äººä¸ºä¹','é›ªä¸­é€ç‚­','è¢–æ‰‹æ—è§‚','å®ˆæœ›ç›¸åŠ©'], a:2},

  {q:'è°è¨€ç»ˆç©¶ä¼šè¢«æ­ç©¿ï¼Œå°±åƒ______åŒ…ä¸ä½ç«ä¸€æ ·ã€‚',
   o:['çº¸','å¸ƒ','æ ‘','è‰'], a:0},

  {q:'ä¸ºäº†å®Œæˆè¿™é¡¹ç ”ç©¶ï¼Œé™ˆæ•™æˆ______ï¼Œç”šè‡³å¿˜äº†ä¼‘æ¯å’Œåƒé¥­ã€‚',
   o:['æ¸¸æ‰‹å¥½é—²','åºŸå¯å¿˜é£Ÿ','æ— æ‰€äº‹äº‹','é¥±é£Ÿç»ˆæ—¥'], a:1},

  {q:'ä¼Ÿæ˜å’Œå¿—å¼ºæ˜¯______çš„å¥½æœ‹å‹ï¼Œä»–ä»¬æœ‰ç€å…±åŒçš„ç†æƒ³å’Œå…´è¶£ã€‚',
   o:['å¿—åŒé“åˆ','è‡­å‘³ç›¸æŠ•','æ ¼æ ¼ä¸å…¥','æ°´ç«ä¸å®¹'], a:0},

  {q:'ä»–è¯´è¯ä¸€å‘______ï¼Œä»æ¥ä¸ä¼šæ‹–æ³¥å¸¦æ°´æˆ–çŠ¹è±«ä¸å†³ã€‚',
   o:['ä¼˜æŸ”å¯¡æ–­','æ–©é’‰æˆªé“','æ¨¡æ£±ä¸¤å¯','åååå'], a:1},

  {q:'è¿™æœ¬å°è¯´æƒ…èŠ‚æ›²æŠ˜ç¦»å¥‡ï¼Œå¼•äººå…¥èƒœï¼Œè®©äººçœ‹äº†______ã€‚',
   o:['æ¯ç‡¥æ— å‘³','çˆ±ä¸é‡Šæ‰‹','åŠé€”è€ŒåºŸ','ä¸å±‘ä¸€é¡¾'], a:1}
];

// ====== å…¨å±€å˜é‡ ======
const selected = Array(questions.length).fill(null);
const answers = Array(questions.length).fill(null);
let studentName = "";
let studentClass = "";

// ====== DOM å…ƒç´  ======
const startScreen = document.getElementById('start-screen');
const quizContent = document.getElementById('quiz-content');
const startBtn = document.getElementById('startBtn');
const nameInput = document.getElementById('student-name');
const classInput = document.getElementById('student-class');
const displayName = document.getElementById('display-name');
const displayClass = document.getElementById('display-class');
const pageArea = document.getElementById('pageArea');
const scoreEl = document.getElementById('score');

// ====== 1. å¼€å§‹æŒ‰é’®é€»è¾‘ ======
startBtn.addEventListener('click', () => {
    const sName = nameInput.value.trim();
    const sClass = classInput.value;

    if (!sName) {
        alert("è¯·è¾“å…¥ä½ çš„åå­—ï¼");
        return;
    }
    if (!sClass) {
        alert("è¯·é€‰æ‹©ä½ çš„ç­çº§ï¼");
        return;
    }

    studentName = sName;
    studentClass = sClass;

    // åˆ‡æ¢ç•Œé¢
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';

    // æ˜¾ç¤ºä¿¡æ¯
    displayName.textContent = `å­¦ç”Ÿï¼š${studentName}`;
    displayClass.textContent = `ç­çº§ï¼š${studentClass}`;

    // æ¸²æŸ“é¢˜ç›®
    render();
});

// ====== 2. æ¸²æŸ“ä¸ç­”é¢˜é€»è¾‘ ======
function render(){
  pageArea.innerHTML='';
  questions.forEach((q,i)=>{
    const card=document.createElement('div');
    card.className='card';
    
    // é¢˜ç›®æ–‡æœ¬
    const qText=document.createElement('div');
    qText.className='q';
    qText.textContent=`${i+1}. ${q.q}`;
    card.appendChild(qText);

    // é€‰é¡¹å®¹å™¨
    const opts=document.createElement('div');
    opts.className='choices';
    
    q.o.forEach((opt,idx)=>{
      const b=document.createElement('button');
      b.className='choice';
      b.textContent=opt;
      b.addEventListener('click',()=>{
        if(answers[i]!==null) return; // é˜²æ­¢é‡å¤ç­”é¢˜
        selected[i]=idx;
        checkAnswer(i,card,opts);
      });
      opts.appendChild(b);
    });
    card.appendChild(opts);
    pageArea.appendChild(card);
  });
}

function checkAnswer(i,card,opts){
  const q=questions[i];
  const chosen=selected[i];
  const btns=opts.querySelectorAll('.choice');
  
  // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
  btns.forEach(b=>b.disabled=true);

  if(chosen===q.a){
    // ç­”å¯¹äº†
    btns[chosen].classList.add('correct');
    answers[i]=true;
  }else{
    // ç­”é”™äº†
    btns[chosen].classList.add('wrong');
    const correctBtn=btns[q.a];
    correctBtn.classList.add('correct-flash');
    setTimeout(()=>{
      correctBtn.classList.remove('correct-flash');
      correctBtn.classList.add('correct');
    },700);
    answers[i]=false;
  }
  updateScore();
  
  // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨ç­”å®Œ
  checkCompletion();
}

function updateScore(){
  const correctCount=answers.filter(v=>v===true).length;
  const answeredCount=answers.filter(v=>v!==null).length;
  
  // åªæœ‰åœ¨æ²¡ç­”å®Œçš„æ—¶å€™æ›´æ–°æ–‡å­—ï¼Œç­”å®Œäº†äº¤ç»™ submitToGoogleSheet æ›´æ–°çŠ¶æ€
  if(answeredCount < questions.length) {
     scoreEl.textContent=`ğŸŒŸ æ­£ç¡®ï¼š${correctCount} / å·²ç­”ï¼š${answeredCount} (å…±${questions.length}é¢˜)`;
  }
}

// ====== 3. æäº¤æ•°æ®åˆ° Google Sheet (æ–°å¢) ======
function submitToGoogleSheet(name, className, score, total) {
    // 1. æ›´æ–°UIæ˜¾ç¤ºæ­£åœ¨æäº¤
    scoreEl.style.backgroundColor = "#fff3e0";
    scoreEl.innerHTML = `â³ æ­£åœ¨æäº¤æˆç»©ï¼Œè¯·ç¨å€™...`;

    // 2. å‡†å¤‡æ•°æ®
    const formData = new URLSearchParams();
    formData.append("name", name);
    formData.append("class", className);
    formData.append("score", score);
    formData.append("total", total);

    // 3. å‘é€è¯·æ±‚
    fetch(SCRIPT_URL, {
        method: 'POST',
        body: formData
    })
    .then(response => response.text())
    .then(text => {
        // æˆåŠŸåçš„å¤„ç†
        scoreEl.style.backgroundColor = "#e8f5e9";
        scoreEl.style.borderColor = "#4caf50";
        scoreEl.style.color = "#1b5e20";
        scoreEl.innerHTML = `âœ… æˆç»©å·²å­˜æ¡£ï¼å¾—åˆ†ï¼š${score}/${total}`;
        
        alert(`ğŸ‰ æ­å–œ ${name} (${className})ï¼\n\nä½ å®Œæˆäº†æ‰€æœ‰æˆè¯­ç»ƒä¹ ã€‚\næ€»å¾—åˆ†ï¼š${score} / ${total}\næˆç»©å·²æˆåŠŸæäº¤ç»™è€å¸ˆï¼`);
    })
    .catch(error => {
        // é”™è¯¯å¤„ç†
        console.error('Error:', error);
        scoreEl.innerHTML = `âš ï¸ æäº¤é‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œè¯·æˆªå›¾ã€‚`;
        alert(`è™½ç„¶åšå®Œäº†ï¼Œä½†ç½‘ç»œæœ‰ç‚¹å¡ã€‚\n\nè¯·æŠŠè¿™ä¸ªç”»é¢æˆªå›¾å‘ç»™è€å¸ˆï¼š\nå§“åï¼š${name}\nåˆ†æ•°ï¼š${score}/${total}`);
    });
}

function checkCompletion() {
    const answeredCount = answers.filter(v => v !== null).length;
    if (answeredCount === questions.length) {
        const correctCount = answers.filter(v => v === true).length;
        
        // å»¶è¿Ÿ800æ¯«ç§’ï¼Œè®©å­¦ç”Ÿçœ‹å®Œæœ€åä¸€é¢˜çš„æ­£ç¡®/é”™è¯¯åŠ¨ç”»ï¼Œå†æäº¤
        setTimeout(() => {
            submitToGoogleSheet(studentName, studentClass, correctCount, questions.length);
        }, 800);
    }
}
</script>
</body>
</html>
